<form [formGroup]="activityReport" (ngSubmit)="onSubmit()">
  @if(storedAgents$ | async; as agents) { @if(agents.length > 0) {
  <div>
    <select name="agents">
      <option value="">-- Sélectionner un agent --</option>
      @for (agent of agents; track $index) {
      <option [value]="agent.id">
        {{ agent.lastName }} {{ agent.firstName }}
      </option>
      }
    </select>
  </div>
  }@else {
  <p>Créer d'abord les agents</p>
  } }
  <div>
    <label for="project">Project</label>
    <input id="project" formControlName="project" />
  </div>
  <div>
    <label for="startDate">Date de début</label>
    <input type="date" id="startDate" formControlName="startDate" />
  </div>
  <div>
    <label for="endDate">Date de fin</label>
    <input type="date" id="endDate" formControlName="endDate" />
  </div>
  <div>
    <label for="activity">Commentaire</label>
    <textarea id="activity" formControlName="activity"></textarea>
  </div>
  <button [disabled]="activityReport.invalid" type="submit">Envoyer</button>
</form>

@if(storedActivityReport$ | async; as activities) { @if(activities.length > 0) {

<h3>Stored Activities:</h3>
<ul>
  @for (activity of activities; track $index) {
  <li>
    {{ activity.activity }} - {{ activity.startDate }} {{ activity.endDate }} -
    {{ activity.project }}
  </li>
  }
</ul>

@if (errorMessage) {
<p>{{ errorMessage }}</p>
} }}
